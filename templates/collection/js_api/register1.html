<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
    <title>Register</title>
</head>
<body>

<div class="container mt-5 mx-auto" style="max-width: 400px;">
    <h2 class="mb-4">Create Account</h2>

    <div class="mb-3">
        <label class="form-label">Username</label>
        <input id="username" class="form-control" placeholder="Enter username">
    </div>

    <div class="mb-3">
        <label class="form-label">Email</label>
        <input id="email" class="form-control" placeholder="Enter email">
    </div>

    <div class="mb-3">
        <label class="form-label">Password</label>
        <input id="password" type="password" class="form-control" placeholder="Enter password">
    </div>

    <button class="btn btn-primary w-100" onclick="registerUser()">Register</button>

    <div id="result" class="mt-3"></div>
</div>


<script>
function registerUser() {
    const username = document.getElementById("username").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    fetch("/register/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify({
            username,
            email,
            password
        })
    })
    .then(async response => {
        const data = await response.json();
        const resultDiv = document.getElementById("result");

        if (!response.ok) {
            // Build pretty error messages
            let html = '<div class="alert alert-danger">';

            for (const field in data) {
                html += `<strong>${field}:</strong> ${data[field].join(", ")}<br>`;
            }

            html += "</div>";
            resultDiv.innerHTML = html;
            return;
        }

        // SUCCESS (Green Alert)
        resultDiv.innerHTML = `
            <div class="alert alert-success">
                ${data.message}
            </div>
        `;
         // Redirect after 1.5 seconds
        setTimeout(() => {
        window.location.href = "/course/";
        }, 1000);


    })
    .catch(error => console.log(error));

}

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let cookie of cookies) {
            cookie = cookie.trim();
            if (cookie.startsWith(name + "=")) {
                cookieValue = cookie.substring(name.length + 1);
            }
        }
    }
    return cookieValue;
}
</script>

</body>
</html>
